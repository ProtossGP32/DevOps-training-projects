<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="ProtossGP32">
<meta name="dcterms.date" content="2023-02-18">
<meta name="description" content="Building our first Kubernetes Cluster">

<title>DevOps Training Projects - 00 - Kubernetes - Getting Started</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../homelab-project/kubernetes-cluster/01-installing-traefik.html" rel="next">
<link href="../../homelab-project/00-introduction.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">DevOps Training Projects</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-devops-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">DevOps exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-devops-exercises">    
        <li class="dropdown-header">Explore California</li>
        <li>
    <a class="dropdown-item" href="../../devops-exercises/explore-california/00-introduction.html">
 <span class="dropdown-text">Explore California</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-devops-tools" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">DevOps tools</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-devops-tools">    
        <li class="dropdown-header">Infrastructure As a Code</li>
        <li>
    <a class="dropdown-item" href="../../devops-tools/infrastructure-as-a-code/00-ansible.html">
 <span class="dropdown-text">00 - Infrastructure As A Code - Ansible</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../devops-tools/infrastructure-as-a-code/01-event-driven-ansible.html">
 <span class="dropdown-text">01 - Management As A Code - Event-Driven Ansible</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Observability</li>
        <li>
    <a class="dropdown-item" href="../../devops-tools/observability/00-what-is-observability.html">
 <span class="dropdown-text">00 - Observability - Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../devops-tools/observability/01-observability-tools.html">
 <span class="dropdown-text">01 - Observability Instrumentation</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-homelab-project" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Homelab project</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-homelab-project">    
        <li>
    <a class="dropdown-item" href="../../homelab-project/00-introduction.html">
 <span class="dropdown-text">Homelab project introduction</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Kubernetes Cluster</li>
        <li>
    <a class="dropdown-item" href="../../homelab-project/kubernetes-cluster/00-getting-started.html">
 <span class="dropdown-text">00 - Kubernetes - Getting Started</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../homelab-project/kubernetes-cluster/01-installing-traefik.html">
 <span class="dropdown-text">01 - Kubernetes - Traefik + cert-manager</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Requirements</li>
        <li>
    <a class="dropdown-item" href="../../homelab-project/requirements/00-requirements.html">
 <span class="dropdown-text">Homelab Requirements</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Self Hosted Software</li>
        <li>
    <a class="dropdown-item" href="../../homelab-project/self-hosted-software/00-docker-and-docker-compose.html">
 <span class="dropdown-text">00 - Containers - Docker &amp; Docker Compose</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../homelab-project/self-hosted-software/01-cloudflare.html">
 <span class="dropdown-text">01 - External access - Cloudflare</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../homelab-project/self-hosted-software/02-traefik-and-portainer.html">
 <span class="dropdown-text">02 - Routing and SSL certificates - Traefik and Portainer</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../homelab-project/self-hosted-software/03-dashy.html">
 <span class="dropdown-text">03 - Homelab dashboard - Dashy</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../homelab-project/self-hosted-software/04-openldap.html">
 <span class="dropdown-text">04 - Authentication - OpenLDAP</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../homelab-project/self-hosted-software/05-nextcloud.html">
 <span class="dropdown-text">05 - Productivity tools - NextCloud</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../homelab-project/self-hosted-software/06-openproject.html">
 <span class="dropdown-text">06 - Productivity tools - OpenProject</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../homelab-project/self-hosted-software/07-sonarqube.html">
 <span class="dropdown-text">07 - Code analysis - SonarQube</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../homelab-project/self-hosted-software/08-guacamole.html">
 <span class="dropdown-text">08 - Remote access - Guacamole</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Virtual Resources Creation</li>
        <li>
    <a class="dropdown-item" href="../../homelab-project/virtual-resources-creation/01-virtual-machines.html">
 <span class="dropdown-text">01 - Provisioning - Virtual Machines on Proxmox</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../homelab-project/virtual-resources-creation/02-containers.html">
 <span class="dropdown-text">02 - Provisioning - LXC (Linux Containers on Proxmox)</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Virtualization Server</li>
        <li>
    <a class="dropdown-item" href="../../homelab-project/virtualization-server/01-installing-proxmox.html">
 <span class="dropdown-text">Part 1 - Installing Proxmox VE</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../homelab-project/virtualization-server/02-virtual-networks.html">
 <span class="dropdown-text">Part 2 - Internal Virtual Networks</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../homelab-project/virtualization-server/03-dns-dhcp-servers.html">
 <span class="dropdown-text">Part 3 - DNS and DHCP servers</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../homelab-project/virtualization-server/04-proxy-http-https-into-internal-network.html">
 <span class="dropdown-text">Part 4 - Proxy HTTP(S) into the internal network</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/protossgp32"><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
                  <a href="" class="quarto-reader-toggle nav-link" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">00 - Kubernetes - Getting Started</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homelab-project/00-introduction.html" class="sidebar-item-text sidebar-link">Homelab project introduction</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Kubernetes Cluster</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homelab-project/kubernetes-cluster/00-getting-started.html" class="sidebar-item-text sidebar-link active">00 - Kubernetes - Getting Started</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homelab-project/kubernetes-cluster/01-installing-traefik.html" class="sidebar-item-text sidebar-link">01 - Kubernetes - Traefik + cert-manager</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Requirements</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homelab-project/requirements/00-requirements.html" class="sidebar-item-text sidebar-link">Homelab Requirements</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Self Hosted Software</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homelab-project/self-hosted-software/00-docker-and-docker-compose.html" class="sidebar-item-text sidebar-link">00 - Containers - Docker &amp; Docker Compose</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homelab-project/self-hosted-software/01-cloudflare.html" class="sidebar-item-text sidebar-link">01 - External access - Cloudflare</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homelab-project/self-hosted-software/02-traefik-and-portainer.html" class="sidebar-item-text sidebar-link">02 - Routing and SSL certificates - Traefik and Portainer</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homelab-project/self-hosted-software/03-dashy.html" class="sidebar-item-text sidebar-link">03 - Homelab dashboard - Dashy</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homelab-project/self-hosted-software/04-openldap.html" class="sidebar-item-text sidebar-link">04 - Authentication - OpenLDAP</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homelab-project/self-hosted-software/05-nextcloud.html" class="sidebar-item-text sidebar-link">05 - Productivity tools - NextCloud</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homelab-project/self-hosted-software/06-openproject.html" class="sidebar-item-text sidebar-link">06 - Productivity tools - OpenProject</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homelab-project/self-hosted-software/07-sonarqube.html" class="sidebar-item-text sidebar-link">07 - Code analysis - SonarQube</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homelab-project/self-hosted-software/08-guacamole.html" class="sidebar-item-text sidebar-link">08 - Remote access - Guacamole</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Virtual Resources Creation</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homelab-project/virtual-resources-creation/01-virtual-machines.html" class="sidebar-item-text sidebar-link">01 - Provisioning - Virtual Machines on Proxmox</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homelab-project/virtual-resources-creation/02-containers.html" class="sidebar-item-text sidebar-link">02 - Provisioning - LXC (Linux Containers on Proxmox)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Virtualization Server</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homelab-project/virtualization-server/01-installing-proxmox.html" class="sidebar-item-text sidebar-link">Part 1 - Installing Proxmox VE</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homelab-project/virtualization-server/02-virtual-networks.html" class="sidebar-item-text sidebar-link">Part 2 - Internal Virtual Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homelab-project/virtualization-server/03-dns-dhcp-servers.html" class="sidebar-item-text sidebar-link">Part 3 - DNS and DHCP servers</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homelab-project/virtualization-server/04-proxy-http-https-into-internal-network.html" class="sidebar-item-text sidebar-link">Part 4 - Proxy HTTP(S) into the internal network</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#main-concepts" id="toc-main-concepts" class="nav-link" data-scroll-target="#main-concepts">Main concepts</a></li>
  </ul></li>
  <li><a href="#requirements" id="toc-requirements" class="nav-link" data-scroll-target="#requirements">Requirements</a>
  <ul class="collapse">
  <li><a href="#ansible-configuration" id="toc-ansible-configuration" class="nav-link" data-scroll-target="#ansible-configuration">Ansible configuration</a></li>
  </ul></li>
  <li><a href="#installation" id="toc-installation" class="nav-link" data-scroll-target="#installation">Installation</a>
  <ul class="collapse">
  <li><a href="#ansible-playbook-launch" id="toc-ansible-playbook-launch" class="nav-link" data-scroll-target="#ansible-playbook-launch">Ansible playbook launch</a></li>
  <li><a href="#deployment-example" id="toc-deployment-example" class="nav-link" data-scroll-target="#deployment-example">Deployment example</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/protossgp32/DevOps-training-projects/edit/main/docs/homelab-project/kubernetes-cluster/00-getting-started.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/protossgp32/DevOps-training-projects/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">00 - Kubernetes - Getting Started</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Kubernetes</div>
    <div class="quarto-category">Ansible</div>
    <div class="quarto-category">k3s</div>
  </div>
  </div>

<div>
  <div class="description">
    Building our first Kubernetes Cluster
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>ProtossGP32 </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 18, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cncf-branding.netlify.app/img/projects/kubernetes/stacked/color/kubernetes-stacked-color.png" height="200" class="figure-img"></p>
</figure>
</div>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Read the <a href="https://kubernetes.io/docs/home/"><em>Kubernetes Official Docs</em></a> for a deeper explanation.</p>
<p>Kubernetes is a container orchestrator engine. What this means is that it manages all the infrastructure resources involved in a microservice deployment, such as networking, number of replicas, access to their endpoints, load balancing requests, etc… Its main purpose is to automate the deployment, scaling and management of containerized applications.</p>
<p>It can be daunting and complex due to the extension of its features, so we’ll try to approach it in the most simple and maintainable way.</p>
<section id="main-concepts" class="level2">
<h2 class="anchored" data-anchor-id="main-concepts">Main concepts</h2>
<p><a href="https://kubernetes.io/docs/concepts/overview/components/"><em>Kubernetes components</em>:</a> A Kubernetes cluster is mainly composed of the following components:</p>
<ul>
<li><em>Control Plane components</em>: these make global decisions about the cluster (scheduling pods) as well as detecting and responding to cluster events
<ul>
<li>They can be run on any machine in the cluster; however, for simplicity, set up scripts typically start all control plane components on the same machine and do not run user containers there</li>
<li>Some of the common control plane components are: <a href="https://kubernetes.io/docs/concepts/overview/components/#kube-apiserver">kube-apiserver</a>, <a href="https://kubernetes.io/docs/concepts/overview/components/#etcd">etcd</a>, <a href="https://kubernetes.io/docs/concepts/overview/components/#kube-scheduler">kube-scheduler</a>, <a href="https://kubernetes.io/docs/concepts/overview/components/#kube-controller-manager">kube-control-manager</a> and <a href="https://kubernetes.io/docs/concepts/overview/components/#cloud-controller-manager">cloud-control-manager</a></li>
</ul></li>
<li><em>Node components</em>: these run on every node, maintaining running pods and providing the Kubernetes runtime environment
<ul>
<li>Some of the common node components are: <a href="https://kubernetes.io/docs/concepts/overview/components/#kubelet">kubelet</a>, <a href="https://kubernetes.io/docs/concepts/overview/components/#kube-proxy">kube-proxy</a> and <a href="https://kubernetes.io/docs/concepts/overview/components/#container-runtime">container runtime</a></li>
</ul></li>
<li><em>Addons</em>: they use Kubernetes resources (DaemonSet, Deployment, etc) to implement cluster features
<ul>
<li>Because these are providing cluster-level features, namespaced resources for addons belong within the <code>kube-system</code> namespace</li>
<li>Selected addons are <a href="https://kubernetes.io/docs/concepts/overview/components/#dns">DNS</a>, <a href="https://kubernetes.io/docs/concepts/overview/components/#web-ui-dashboard">Web UI (Dashboard)</a>, <a href="https://kubernetes.io/docs/concepts/overview/components/#container-resource-monitoring">Container Resource Monitoring</a> and <a href="https://kubernetes.io/docs/concepts/overview/components/#cluster-level-logging">Cluster-level Logging</a></li>
</ul></li>
</ul>
<p>As described above, usually all control plane components are deployed into the same machine or node. Another usual thing to do is to isolate the control plane nodes to prevent them to act as <em>workers</em>; this ensures that their critical mission of overseeing the whole cluster isn’t compromised due to a highly demanding user container.</p>
<p>When dealing with High-Availability, we’ll configure more than one control plane node to ensure redundancy.</p>
</section>
</section>
<section id="requirements" class="level1">
<h1>Requirements</h1>
<p>In order for us to easily deploy our first Kubernetes cluster, we’ll rely on <a href="https://docs.technotim.live/posts/k3s-etcd-ansible/">TechnoTim’s guide to deploy k3s with Ansible playbooks</a>. This guide guarantees a 100% automated k3s deployment, so we’ll give it a try.</p>
<p>For this guide, we’ll need the following resources:</p>
<ul>
<li><p>A central machine from where we’ll launch Ansible playbooks and access our k3s cluster:</p>
<ul>
<li>Ansible on Debian/Ubuntu distros: <a href="https://docs.technotim.live/posts/ansible-automation/">Installation process</a></li>
<li>Ansible on Alpine: <a href="https://wiki.alpinelinux.org/wiki/Ansible">Installation process</a></li>
</ul>
<p><strong>We’ll be using an LXC with Alpine installed (128MB of RAM and 2GB of disk)</strong></p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Installing kubectl and ansible on alpine</strong></pre>
</div>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Installing kubectl</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="ex">apk</span> add curl</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="ex">curl</span> <span class="at">-LO</span> <span class="st">"https://dl.k8s.io/release/</span><span class="va">$(</span><span class="ex">curl</span> <span class="at">-L</span> <span class="at">-s</span> https://dl.k8s.io/release/stable.txt<span class="va">)</span><span class="st">/bin/linux/amd64/kubectl"</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">mv</span> kubectl /sbin/</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">chmod</span> u+x /sbin/kubectl</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co"># Installing ansible</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="ex">apk</span> add ansible</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ul>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Enable SSH in LXC container
</div>
</div>
<div class="callout-body-container callout-body">
<p>Accessing LXC through serial console attachment is a pain. When creating it in Proxmox, we had the chance to add our SSH key, but OpenSSH isn’t installed by default in Alpine images. Attach to the LXC and do the following:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Alpine: install OpenSSH and enable it on boot</strong></pre>
</div>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1"></a><span class="ex">apk</span> add openssh</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="ex">rc-update</span> add sshd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Check that your public key is already shared with the container:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Alpine: authorized keys</strong></pre>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">cat</span> ~/.ssh/authorized_keys</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<ul>
<li>At least 5 VMs for our cluster (2 CPU, 2GB of RAM and at least 5GB of disk):
<ul>
<li>3 for control plane:
<ul>
<li>k3s-control-1</li>
<li>k3s-control-2</li>
<li>k3s-control-3</li>
</ul></li>
<li>2 for workers:
<ul>
<li>k3s-worker-1</li>
<li>k3s-worker-2</li>
</ul></li>
</ul></li>
</ul>
<section id="ansible-configuration" class="level2">
<h2 class="anchored" data-anchor-id="ansible-configuration">Ansible configuration</h2>
<p>Follow the guide’s instructions, clone its <code>git</code> repository and make sure you update the following files. Make a copy of the <code>/inventory/sample</code> directory and name it <code>/inventory/my-cluster</code>. After that, modify the following files according to your servers:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>inventory/my-cluster/hosts.ini</strong></pre>
</div>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">[</span><span class="at">master</span><span class="kw">]</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="at">k3s-control-1</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="at">k3s-control-2</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="at">k3s-control-3</span></span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="kw">[</span><span class="at">node</span><span class="kw">]</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="at">k3s-worker-1</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="at">k3s-worker-2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
SSH keys
</div>
</div>
<div class="callout-body-container callout-body">
<p>Remember to exchange your SSH public key with the rest of the servers, else Ansible will fail to launch the commands.</p>
</div>
</div>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>inventory/my-cluster/group_vars/all.yml</strong></pre>
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># this is the user that has ssh access to these machines</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co"># You have to exchange your public SSH key with them</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="fu">ansible_user</span><span class="kw">:</span><span class="at"> </span><span class="st">"common-user-to-all-servers"</span></span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co"># apiserver_endpoint is virtual ip-address which will be configured on each master</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co"># Make sure this IP is within the network range and is reachable</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="fu">apiserver_endpoint</span><span class="kw">:</span><span class="at"> </span><span class="st">"192.168.30.222"</span></span>
<span id="cb5-8"><a href="#cb5-8"></a></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co"># k3s_token is required  masters can talk together securely</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co"># this token should be alpha numeric only</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="fu">k3s_token</span><span class="kw">:</span><span class="at"> </span><span class="st">"some-SUPER-DEDEUPER-secret-password"</span></span>
<span id="cb5-12"><a href="#cb5-12"></a></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co"># metallb ip range for load balancer</span></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="co"># You might want to avoid matching ranges with your network     </span></span>
<span id="cb5-15"><a href="#cb5-15"></a><span class="fu">metal_lb_ip_range</span><span class="kw">:</span><span class="at"> </span><span class="st">"192.168.30.80-192.168.30.90"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Using Alpine server for Ansible
</div>
</div>
<div class="callout-body-container callout-body">
<p>You may need to launch the following commands:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># For cluster servers in different subnets</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="ex">apk</span> add py3-netaddr</span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co"># For installing ansible-galaxy requirements</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co"># Regenerate SSL certificates</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co"># Guide: https://wiki.alpinelinux.org/wiki/Generating_SSL_certs_with_ACF</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="ex">/sbin/setup-acf</span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="ex">apk</span> add acf-openssl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
</section>
<section id="installation" class="level1">
<h1>Installation</h1>
<section id="ansible-playbook-launch" class="level2">
<h2 class="anchored" data-anchor-id="ansible-playbook-launch">Ansible playbook launch</h2>
<p>Now launch the following command from the repository root:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Ansible command</strong></pre>
</div>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Install ansible requirements</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="ex">ansible-galaxy</span> install <span class="at">-r</span> ./collections/requirements.yml</span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co"># Launch the installation playbook</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="ex">ansible-playbook</span> ./site.yml <span class="at">-i</span> ./inventory/my-cluster/hosts.ini</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Check for any errors during the ansible-playbook execution. If everything is OK, proceed to copy the k3s cluster config into the central server:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Copying cluster config and testing</strong></pre>
</div>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Make sure the '.kube' folder exists in the local server</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="fu">mkdir</span> ~/.kube</span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co"># Copy the config from one of the master nodes</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="fu">scp</span> common-user-to-all-servers@k3s-control-1:~/.kube/config ~/.kube/config</span>
<span id="cb8-6"><a href="#cb8-6"></a></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co"># Check that we can access the cluster</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="fu">sudo</span> kubectl get nodes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Worker nodes not showing in the cluster in the first attempt
</div>
</div>
<div class="callout-body-container callout-body">
<p>Check what’s wrong with the ansible steps when reaching workers</p>
</div>
</div>
<p>After restarting the nodes and launching the playbook several times, now all nodes appear in the k3s cluster:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>kubectl check of nodes</strong></pre>
</div>
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1"></a><span class="ex">~/k3s-ansible</span> <span class="co"># kubectl get nodes</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="ex">NAME</span>            STATUS   ROLES                       AGE     VERSION</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="ex">k3s-control-1</span>   Ready    control-plane,etcd,master   22m     v1.24.10+k3s1</span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="ex">k3s-control-2</span>   Ready    control-plane,etcd,master   22m     v1.24.10+k3s1</span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="ex">k3s-control-3</span>   Ready    control-plane,etcd,master   22m     v1.24.10+k3s1</span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="ex">k3s-worker-1</span>    Ready    <span class="op">&lt;</span>none<span class="op">&gt;</span>                      5m14s   v1.24.10+k3s1</span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="ex">k3s-worker-2</span>    Ready    <span class="op">&lt;</span>none<span class="op">&gt;</span>                      5m2s    v1.24.10+k3s1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="deployment-example" class="level2">
<h2 class="anchored" data-anchor-id="deployment-example">Deployment example</h2>
<p>The <code>git</code> repository has a deployment example of nginx web servers configured to 3 replicas as well as a load balancer service for it.</p>
<p>Once deployed with the following commands:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Deploying our first application</strong></pre>
</div>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> example/deployment.yml</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> example/service.yml</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We should see 3 nginx pods and a service:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Pods deployed on different nodes</strong></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1"></a><span class="ex">~/k3s-ansible</span> <span class="co"># kubectl get pods -o wide</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="ex">NAME</span>                     READY   STATUS    RESTARTS   AGE     IP          NODE           NOMINATED NODE   READINESS GATES</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="ex">nginx-6fb79bc456-79v99</span>   1/1     Running   0          5m47s   10.42.4.3   k3s-worker-2   <span class="op">&lt;</span>none<span class="op">&gt;</span>           <span class="op">&lt;</span>none<span class="op">&gt;</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="ex">nginx-6fb79bc456-gj6zh</span>   1/1     Running   0          5m47s   10.42.3.3   k3s-worker-1   <span class="op">&lt;</span>none<span class="op">&gt;</span>           <span class="op">&lt;</span>none<span class="op">&gt;</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="ex">nginx-6fb79bc456-qj472</span>   1/1     Running   0          5m47s   10.42.4.2   k3s-worker-2   <span class="op">&lt;</span>none<span class="op">&gt;</span>           <span class="op">&lt;</span>none<span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Load-balancer service for the Nginx replicas</strong></pre>
</div>
<div class="sourceCode" id="cb12"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1"></a><span class="ex">~/k3s-ansible</span> <span class="co"># kubectl get service -o wide</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="ex">NAME</span>         TYPE           CLUSTER-IP     EXTERNAL-IP   PORT<span class="er">(</span><span class="ex">S</span><span class="kw">)</span>        <span class="ex">AGE</span>     SELECTOR</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="ex">kubernetes</span>   ClusterIP      10.43.0.1      <span class="op">&lt;</span>none<span class="op">&gt;</span>        443/TCP        34m     <span class="op">&lt;</span>none<span class="op">&gt;</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="ex">nginx</span>        LoadBalancer   10.43.170.67   10.0.0.11     80:30466/TCP   6m16s   app=nginx</span>
<span id="cb12-5"><a href="#cb12-5"></a></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="ex">~/k3s-ansible</span> <span class="co"># kubectl describe service nginx</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="ex">Name:</span>                     nginx</span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="ex">Namespace:</span>                default</span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="ex">Labels:</span>                   <span class="op">&lt;</span>none<span class="op">&gt;</span></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="ex">Annotations:</span>              <span class="op">&lt;</span>none<span class="op">&gt;</span></span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="ex">Selector:</span>                 app=nginx</span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="ex">Type:</span>                     LoadBalancer <span class="co"># Here we see that the service type is a load balancer between all the available nginx replicas</span></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="ex">IP</span> Family Policy:         PreferDualStack</span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="ex">IP</span> Families:              IPv4</span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="ex">IP:</span>                       10.43.170.67 <span class="co"># This is the Cluster IP assigned to the service</span></span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="ex">IPs:</span>                      10.43.170.67</span>
<span id="cb12-17"><a href="#cb12-17"></a><span class="ex">LoadBalancer</span> Ingress:     10.0.0.11 <span class="co"># This is the IP assigned by the MetalLB controller as an Ingress access point</span></span>
<span id="cb12-18"><a href="#cb12-18"></a><span class="ex">Port:</span>                     <span class="op">&lt;</span>unset<span class="op">&gt;</span>  80/TCP</span>
<span id="cb12-19"><a href="#cb12-19"></a><span class="ex">TargetPort:</span>               80/TCP</span>
<span id="cb12-20"><a href="#cb12-20"></a><span class="ex">NodePort:</span>                 <span class="op">&lt;</span>unset<span class="op">&gt;</span>  30466/TCP</span>
<span id="cb12-21"><a href="#cb12-21"></a><span class="ex">Endpoints:</span>                10.42.3.3:80,10.42.4.2:80,10.42.4.3:80 <span class="co"># Here we can see the endpoints of the nginx replicas</span></span>
<span id="cb12-22"><a href="#cb12-22"></a><span class="ex">Session</span> Affinity:         None</span>
<span id="cb12-23"><a href="#cb12-23"></a><span class="ex">External</span> Traffic Policy:  Cluster</span>
<span id="cb12-24"><a href="#cb12-24"></a><span class="ex">Events:</span></span>
<span id="cb12-25"><a href="#cb12-25"></a>  <span class="ex">Type</span>    Reason        Age    From                Message</span>
<span id="cb12-26"><a href="#cb12-26"></a>  <span class="ex">----</span>    <span class="at">------</span>        <span class="at">----</span>   <span class="at">----</span>                <span class="at">-------</span></span>
<span id="cb12-27"><a href="#cb12-27"></a>  <span class="ex">Normal</span>  IPAllocated   6m34s  metallb-controller  Assigned IP [<span class="st">"10.0.0.11"</span>]</span>
<span id="cb12-28"><a href="#cb12-28"></a>  <span class="ex">Normal</span>  nodeAssigned  6m34s  metallb-speaker     announcing from node <span class="st">"k3s-control-2"</span> with protocol <span class="st">"layer2"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../homelab-project/00-introduction.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Homelab project introduction</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../homelab-project/kubernetes-cluster/01-installing-traefik.html" class="pagination-link">
        <span class="nav-page-text">01 - Kubernetes - Traefik + cert-manager</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">
        <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../about.html">About</a>
  </li>  
</ul>
      </div>
  </div>
</footer>



</body></html>